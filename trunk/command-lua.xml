<?xml version="1.0" encoding="UTF-8"?>
<mod name="command-lua" version="1.0" author="slawkens, elf" contact="otland.net" enabled="yes">
	<talkaction words="/lua" access="6" event="script"><![CDATA[
		function onSay(cid, words, param, channel)
			param = string.gsub(param, "cid", cid)
			--local f = assert(loadstring(param))
			local f = loadstring(param)
			local status, ret = pcall(f)

			local ret_type = type(ret)
			if(table.isStrIn(ret_type, {'number', 'string', 'boolean', 'table', 'function'})) then
				if(ret == true or ret == false) then
					ret = tostring(ret)
				elseif(ret_type == 'table') then
					ret = '(table)\n' .. table.totext(ret, 1, true)
				elseif(ret_type == 'function') then
					ret = 'function'
				end
				doPlayerSendTextMessage(cid, MESSAGE_STATUS_CONSOLE_BLUE, "Result: " .. ret)
			else
				doPlayerSendTextMessage(cid, MESSAGE_STATUS_CONSOLE_BLUE, "Code executed, without result.")
			end
			return true
		end
	]]></talkaction>
</mod>
